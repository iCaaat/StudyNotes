# 初识编码格式

## 🧩 一、什么是“编码格式”？

简单说：

> **编码（Encoding）是文字 → 数字的转换规则。**

计算机内部只能存储 **二进制（0 和 1）**。
 而我们写的文字（比如 "你好"、"A"、"😀"）在保存到文件时，需要转换成二进制。

**编码格式** 就规定了这种“转换规则”。
 例如：

| 字符 | 在 UTF-8 中 | 在 GBK 中       |
| ---- | ----------- | --------------- |
| A    | 0x41        | 0x41            |
| 中   | E4 B8 AD    | D6 D0           |
| 😀    | F0 9F 98 80 | ❌（GBK 不支持） |

所以：

- UTF-8、GBK、UTF-16、ISO-8859-1 等，都是不同的“文字 ↔ 二进制”的映射方式。

------

## 💡 二、编码格式存在的意义

举个例子：

你在 Windows 上保存一个文件为 GBK 编码：

```
你好
```

然后 Linux（默认 UTF-8）去打开这个文件，就可能看到乱码：

```
浣犲ソ
```

👉 因为读取时用错了解码规则。
 就好像明明是中文发音，却用英文字母去读，当然就错了。

------

## ⚙️ 三、哪些文件有“编码格式”的概念？

| 文件类型                                              | 是否有编码格式 | 说明                                           |
| ----------------------------------------------------- | -------------- | ---------------------------------------------- |
| `.java`、`.py`、`.html`、`.xml`、`.txt` 等文本文件    | ✅ 有           | 因为存储的是人类可读文字（源码、标签、注释）   |
| `.class`、`.exe`、`.jpg`、`.png`、`.zip` 等二进制文件 | ❌ 没有         | 这些文件是机器可读的二进制格式，不依赖文本编码 |
| 数据库文件、音频文件                                  | ⚙️ 一般没有     | 它们有自己的内部结构和协议                     |

换句话说：

> **只有“纯文本文件”才谈得上编码格式。**

---

# 四个追问

## 🧩 追问 1：有多少编码格式？使用场景分别是什么？

我们可以从“**历史演进**”的角度看：

| 编码格式                   | 起源/背景      | 支持范围                                  | 特点 / 使用场景                               |
| -------------------------- | -------------- | ----------------------------------------- | --------------------------------------------- |
| **ASCII**                  | 1960年代，美国 | 只支持英文字母、数字、符号，共 128 个字符 | 最古老的编码，所有现代编码的基础              |
| **ISO-8859 系列**          | 欧洲           | 西欧、东欧语言                            | 在 ASCII 基础上扩展                           |
| **GB2312 / GBK / GB18030** | 中国大陆       | 简体中文                                  | Windows 中文版的默认编码；GB18030 是国家标准  |
| **Big5**                   | 中国台湾       | 繁体中文                                  | 主要用于台湾/香港旧系统                       |
| **Shift-JIS / EUC-JP**     | 日本           | 日文                                      | Windows 和 Unix 日文系统常用                  |
| **UTF-8**                  | Unicode 标准   | 支持全球所有语言                          | 最通用的编码格式（网页、Linux、现代软件通用） |
| **UTF-16 / UTF-32**        | Unicode 标准   | 支持全球所有语言                          | Java、Windows 内部常用（定长字节，处理快）    |

🌍 **现实总结：**

- 早期：每个国家/地区发明自己的编码（GBK、Big5、Shift-JIS）；
- 后来：互联网需要**全球通用标准**，于是出现 **Unicode**；
- Unicode 是“字符集规范”，UTF-8、UTF-16、UTF-32 是“编码实现”；
- 现在几乎所有现代系统都倾向使用 **UTF-8**。

------

## ⚙️ 追问 2：为什么 Windows 不默认 UTF-8，而 Linux 不默认 GBK？

这其实是“**历史兼容性**”问题，不是技术问题。

### 🪟 Windows 的情况

- Windows 在 1990 年代面向全球推广时，针对不同地区预装了“**本地化语言包**”；
- 中国区就使用了 GBK 编码，因为那时 Unicode 还没普及；
- 为了兼容旧版软件（尤其是早期中文软件），微软至今仍维持默认编码为 **GBK (CP936)**；
- 虽然现在 Windows 11 已经支持“使用 UTF-8 作为全球语言支持”，但默认仍是关闭的（兼容性考虑）。

### 🐧 Linux 的情况

- Linux 出生较晚（1990 年代中期），又主要用于服务器、网络；
- 它从一开始就面向全球技术社区；
- 所以它几乎一开始就采用 **UTF-8**；
- 不同发行版都默认 UTF-8，这样全世界的程序都能互通。

📌 **一句话总结：**

> Windows 早出生，需要照顾旧系统；Linux 出生晚，可以一开始就统一 UTF-8。

------

## 💡 追问 3：为什么大多数文本编辑器都默认使用 UTF-8？

非常关键的问题。主要有三个原因：

### ① 通用性强

UTF-8 能表示世界上所有语言的字符；

> “一次编码，全球通用。”

这意味着：

- 你写的文件可以在任何平台打开；
- 英文仍只占 1 个字节，中文才 3 个字节 → 效率也不差。

### ② 向后兼容 ASCII

UTF-8 的前 128 个字符与 ASCII 一模一样。

> 所以旧的英文文件完全不用重新编码。

### ③ 网络标准要求

所有 Web 技术（HTML、HTTP、JSON、XML、JavaScript）都推荐或要求使用 UTF-8。

📘 所以：

- Windows 新版记事本（Windows 10/11）默认 UTF-8；
- VS Code、Notepad++、Sublime、Eclipse、IntelliJ 等全部默认 UTF-8；
- 这已经是事实上的“国际标准”。

------

## 🧠 追问 4：操作系统、Java、编辑器都认识这些编码吗？它们是怎么做到“自动转换”的？

非常棒的核心问题。答案是——**是的，它们内置了编码表和转换算法。**

让我们分层看👇

### （1）操作系统层面

- Windows、Linux、macOS 内部都维护着一张“编码 ↔ 字符”对照表。

- 比如 GBK 中：

  ```
  0xC4E3 → '你'
  0xBAC3 → '好'
  ```

  UTF-8 中：

  ```
  E4 BD A0 → '你'
  E5 A5 BD → '好'
  ```

- 所以操作系统本身就“认识”这些编码。

------

### （2）Java 层面

- Java 自带一整套编码实现（基于 `Charset` 类）。

- 例如：

  ```
  Charset.availableCharsets()
  ```

  会列出系统支持的所有编码。

- 转换编码的底层逻辑其实是查表，比如：

  ```
  new String(bytes, "GBK")
  ```

  就是用“GBK 对照表”把二进制还原成字符。

Java 支持 100+ 种编码格式（UTF-8、GBK、ISO8859-1、Shift_JIS 等）。

------

### （3）文本编辑器层面

- 编辑器其实就是：
  1. 打开文件 → 读入二进制；
  2. 根据你选择的编码表（比如 UTF-8）转换成字符；
  3. 显示在屏幕上；
  4. 保存时，再按选定编码表转回二进制写入。

所以当你在 Notepad++ 里选“转换为 UTF-8”，它实质上是：

> 先读取旧的字节 → 按旧编码表解码成字符 → 再按 UTF-8 编码表重新编码。

------

## 🔍 总结整合

| 层级            | 谁决定编码       | 默认值                   | 是否可改            | 说明                             |
| --------------- | ---------------- | ------------------------ | ------------------- | -------------------------------- |
| 操作系统        | 区域语言设置     | Windows=GBK，Linux=UTF-8 | ✅                   | 控制台和系统默认文件编码         |
| 编辑器          | 保存选项         | 多为 UTF-8               | ✅                   | 决定文件写入时的编码             |
| Java 源码       | `javac` 编译参数 | 系统默认                 | ✅ `-encoding`       | 控制编译时读取源码的编码         |
| Java 程序运行时 | JVM 属性         | 系统默认                 | ✅ `-Dfile.encoding` | 控制程序内部字符串与文件IO的编码 |